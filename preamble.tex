\usepackage{blindtext} % использовалось для тестирований

% для использования с xe(la)tex
\usepackage{fontspec}
\usepackage[english,russian]{babel}
\setmainfont{Times New Roman}
\setmonofont{JetBrains Mono} % a font with cyrillic


% изменить название содержания
\addto\captionsrussian{\renewcommand{\contentsname}{СОДЕРЖАНИЕ}}

% 14 шрифт в документы
\usepackage[14pt]{extsizes}

% изменение стиля содержания
\usepackage{tocloft}
\renewcommand{\cftsecfont}{\normalfont}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsecpagefont}{\normalsize}
\setlength{\cftbeforesecskip}{0cm}
\setlength{\cftbeforesubsecskip}{0cm}
\setlength{\cftbeforesubsubsecskip}{0cm}
\setlength{\cftbeforeparaskip}{0cm}
\renewcommand{\cfttoctitlefont}{\hfill\large\bfseries}
\renewcommand{\cftaftertoctitle}{\hfill\hfill}

% добавляем параграфы в содержание и добавляем нумерацию
\setcounter{tocdepth}{5}
\setcounter{secnumdepth}{5}


% математика
\usepackage{amsmath,amssymb,amsfonts,icomma,mathtools}

% картинки (в квардратные скобки можно прописать draft и картинки будут добавляться ссылками, компиляция быстрее)
\usepackage[]{graphicx}

% гиперссылки и ссылки в документе (плюс формат ссылок Times New Roman'ом)
\usepackage[unicode]{hyperref}
\hypersetup{
	colorlinks,
	citecolor=black,
	filecolor=black,
	linkcolor=black,
	urlcolor=blue
}
\usepackage{url}
\urlstyle{same}

% размер шрифта разделов (нормальный)
\usepackage{sectsty}
\allsectionsfont{\bfseries\normalsize}

% изменяем стиль section/subsection/subsubsection
\makeatletter
\renewcommand{\section}{\@startsection{section}%
	{4}% level
	{0ex}% indent
	{12pt}% beforeskip
	{8pt}% afterskip
	{\normalfont\normalsize\bfseries}} %style
\makeatother

\makeatletter
\renewcommand{\subsection}{\@startsection{subsection}%
	{4}% level
	{0ex}% indent
	{12pt}% beforeskip
	{8pt}% afterskip
	{\normalfont\normalsize\bfseries}} %style
\makeatother

\makeatletter
\renewcommand{\subsubsection}{\@startsection{subsubsection}%
	{4}% level
	{0ex}% indent
	{12pt}% beforeskip
	{8pt}% afterskip
	{\normalfont\normalsize\bfseries}} %style
\makeatother

% изменяем стиль paragraph/subparagraph
\makeatletter
\renewcommand{\paragraph}{\@startsection{paragraph}%
	{4}% level
	{0ex}% indent
	{12pt}% beforeskip
	{8pt}% afterskip
	{\normalfont\normalsize\bfseries}} %style
\makeatother

\makeatletter
\renewcommand{\subparagraph}{\@startsection{subparagraph}
	{4}% level 
	{0ex}% indent
	{12pt}% beforeskip
	{8pt}% afterskip
	{\normalfont\normalsize\bfseries}} %style
\makeatother

% размер полей (по ГОСТу)
\usepackage[left=3cm,right=1cm, top=2cm, bottom=2cm]{geometry}

% полуторный интервал между строками
\usepackage[nodisplayskipstretch]{setspace}
\setstretch{1.5}

% отступ с первой строки
\usepackage{indentfirst}
% красная строка для всего документа 
\setlength{\parindent}{1.25cm}

% библиография по госту
\usepackage[
backend=biber,
maxbibnames=5,
natbib=true,
style=gost-numeric,
citestyle=numeric-comp,
sorting=none,
sortcites=true
]{biblatex}
%\bibliography{bibfile}


% команды, которые будут запущены в начале каждого документа
\AtBeginDocument{%
	\graphicspath{{../images},{images}} % первое для сабфайлов, второе для основного
}

% команды к конце каждого документа (полезно для subfiles)
\AtEndDocument{%
	\clearpage
	\newpage
	\sloppy
	%\printbibliography[heading=bibintoc, title=СПИСОК ИСПОЛЬЗОВАННЫХ ИСТОЧНИКОВ]
	%\label{verylastpage}
}

% для расширения функциональности таблиц
\usepackage{array}
\usepackage{multirow}
\usepackage{multicol}

% вставка листингов кода
\usepackage[final]{listings}
\usepackage{color} % создание собственной цветовой схемы
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\definecolor{codegreen}{rgb}{0,0.6,0}

\lstdefinestyle{myStyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	basicstyle=\ttfamily\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	keepspaces=true,                 
	numbers=left,       
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=1
}
\lstset{style=myStyle}

% автоподсчёт флотов в рефератеч
\usepackage{xspace}
\usepackage[figure,table,equation,lstlisting]{totalcount}
\usepackage{pdfpages}
% считать количество элементов в библиографии
\usepackage{totcount}
\newtotcounter{citenum}
\AtEveryBibitem{\stepcounter{citenum}}

% свои команды
\newcommand{\ten}[1]{\cdot 10^{#1}} % возводить в степень
\newcolumntype{C}[1]{>{\centering\arraybackslash}m{#1}} % новый тип колонки в таблицах с центрированием по высоте и ширине
\newcolumntype{L}[1]{>{\flushleft\arraybackslash}m{#1}} % новый тип колонки в таблицах с центрированием по высоте и ширине (allign-center)
\newcolumntype{P}[1]{>{\raggedright\arraybackslash}p{#1}} % аналогично
\newcommand{\rbf}[1]{\textbf{\ref{#1}}} % жирное цитирование
\newcommand{\refpar}[1]{\S\rbf{#1} на стр. \textbf{\pageref{#1}}} % цитирование номера параграфа с указанием на страницу
\newcommand{\refris}[1]{рис. \rbf{#1}} % ссылка на рисунок
\newcommand{\reftab}[1]{табл. \rbf{#1}} % ссылка на таблицу
\newcommand{\rt}[1]{_\text{#1}} % писать русский и не только текст в подстрочном режиме в математике
\newenvironment{aleq}{\begin{equation}\begin{aligned}}{\end{aligned}\end{equation}} % несколько уравнений под одной цифрой

% субфигуры (много картинок в одной)
\usepackage[labelformat=simple, labelformat=brace]{subcaption}
\captionsetup{subrefformat=parens}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}

% настройка подписей к картинкам, таблицам и прочее
\usepackage{floatrow}
%костыли

\DeclareFloatVCode{beforefloat}{\vspace{5pt}}
\DeclareFloatVCode{afterfloat}{\vspace{-15pt}}
\floatsetup{precode=beforefloat,postcode=afterfloat,captionskip=15pt}

\floatsetup[table]{capposition=top}
\usepackage[labelsep=endash]{caption}
\captionsetup[table]{singlelinecheck=false,position=top, justification=centering} %слева ужасно выглядит, договорились по центру делать

% отступ после уравнений (при написании вставлять уравнения вместе с текстом, не разделять их абзацной строкой)
\setlength{\abovedisplayskip}{0pt}
\setlength{\belowdisplayskip}{0pt}


% настройка списков (нумерованных и bullet) (НУЖЕН РЕФАКТОРИНГ)
\usepackage{enumitem}
\renewcommand{\labelitemi}{--}
\renewcommand{\labelitemii}{--}
\renewcommand{\labelitemiii}{--}
\usepackage{enumitem}

\setlist{nolistsep} % убираем дополнительные вертикальные отступы вокруг списков

% стили для нумерованного и bullet списков 
\setlist[enumerate]{leftmargin=1.75cm,itemindent=0pt}
\setlist[itemize]{leftmargin=1.75cm,itemindent=0pt}

%\setenumerate[1]{itemindent=2.7em,
%listparindent=\parindent} % для нумерованного списка
%\setenumerate[2]{itemindent=2.7em,
%listparindent=2\parindent,leftmargin=2\parindent}
%
\renewcommand{\labelenumii}{\theenumii} % стиль первого слоя
\renewcommand{\theenumii}{\theenumi.\arabic{enumii}.} % стиль второго слоя
%
%\setitemize[1]{itemindent=2.7em,
%listparindent=\parindent} % для bullet
%\setitemize[2]{itemindent=2.7em,
%listparindent=2\parindent,leftmargin=2\parindent}

%\setlength{\intextsep}{\parskip}

% использование множества файлов с возможностью отдельной компиляции
\usepackage{xr}
\usepackage{subfiles}
\addbibresource{\subfix{bibfile.bib}} % добавил файл с библиографией
\externaldocument{\subfix{template.tex}}

% небольшие добавления диплома (= подсекция свои команды)
%рисует двойную линию в титульном листе
\newcommand{\drawduallines}{\noindent\rule{\textwidth}{4pt}
	
	\vspace{-0.8cm}
	
	\noindent\rule{\textwidth}{1pt}	}
	
\newcommand{\ulinedtext}[2]{$\underset{\text{#2}}{\uline{\text{#1}}}$} % нужно для таблице в титульном листе

\usepackage[normalem]{ulem} % нижнее подчеркивание текста
\usepackage{calc} % команда widthof для титульного
\newcommand{\uname}[1]{\ulinedtext{\hspace{0.5\linewidth-{\widthof{#1}*\real{0.5}}} #1  \hspace{0.5\linewidth-{\widthof{#1}*\real{0.5}}}}{(И.О.Фамилия)}} % работает и не трогате, нужно для того, чтобы подчёркнутый текст в титульном листе имел одну длину (одну длину имела сама линия)

\newcommand{\whr}{\text{, где}} % писать "где" после уравнения
\usepackage[version=4]{mhchem} % химия
\usepackage{placeins} % команда \FloatBarrier, полезная, если картинки и прочие float располагаются автоматически; не даёт картинкам убегать за пределы глав. Используется в ручном режиме после команды \section{} и подобных

\newcommand{\razm}[1]{\hspace{1ex} \ensuremath{\left[\text{#1}\right]}} % размерность в квадраных скобках 
\newcommand{\grad}{\ensuremath{^\circ}} % значок градусу
